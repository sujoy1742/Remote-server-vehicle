function mapvalue(a,b,c,d,e){return parseInt((a-b)*(e-d)/(c-b)+d)}function horn(){0==h?h=1:h=0,0==h?($("#hornclass").removeClass("icon-sound"),$("#hornclass").addClass("icon-sound4"),$("#horn1class").removeClass("badge-positive"),$("#horn1class").addClass("badge-negative")):($("#hornclass").removeClass("icon-sound4"),$("#hornclass").addClass("icon-sound"),$("#horn1class").removeClass("badge-negative"),$("#horn1class").addClass("badge-positive"))}function light(){0==l?l=1:l=0,0==l?($("#lightclass").removeClass("icon-star-filled"),$("#lightclass").addClass("icon-star"),$("#light1class").removeClass("badge-positive"),$("#light1class").addClass("badge-negative")):($("#lightclass").removeClass("icon-star"),$("#lightclass").addClass("icon-star-filled"),$("#light1class").removeClass("badge-negative"),$("#light1class").addClass("badge-positive"))}function left(){0==li?li=1:li=0,0==li?($("#leftclass").removeClass("btn-positive"),$("#leftclass").addClass("btn-negative")):($("#leftclass").removeClass("btn-negative"),$("#leftclass").addClass("btn-positive"))}function right(){0==ri?ri=1:ri=0,0==ri?($("#rightclass").removeClass("btn-positive"),$("#rightclass").addClass("btn-negative")):($("#rightclass").removeClass("btn-negative"),$("#rightclass").addClass("btn-positive"))}function carstart(){0==start&&($("#startclass").removeClass("icon-close"),$("#startclass").addClass("icon-check"),$("#start1class").removeClass("badge-negative"),$("#start1class").addClass("badge-positive"),$("#stopclass").addClass("icon-close"),$("#stopclass").removeClass("icon-check"),$("#stop1class").addClass("badge-negative"),$("#stop1class").removeClass("badge-positive"),start=1,stop=0)}function carstop(){0==stop&&(start=0,stop=1,$("#stopclass").removeClass("icon-close"),$("#stopclass").addClass("icon-check"),$("#stop1class").removeClass("badge-negative"),$("#stop1class").addClass("badge-positive"),$("#startclass").addClass("icon-close"),$("#startclass").removeClass("icon-check"),$("#start1class").addClass("badge-negative"),$("#start1class").removeClass("badge-positive"))}function data(){psteer==steer&&pspeed==speed&&pl==l&&ph==h&&pri==ri&&pli==li||(0==start?pl==l&&ph==h&&pri==ri&&pli==li||($.ajax({url:"/post_data/",type:"POST",data:{data:'{"s":90,"m":0,"l":'+l+',"h":'+h+',"ri":'+ri+',"li":'+li+"}"}}),pli=li,pri=ri,ph=h,pl=l):($.ajax({url:"/post_data/",type:"POST",data:{data:'{"s":'+parseInt(steer)+',"m":'+parseInt(speed)+',"l":'+l+',"h":'+h+',"ri":'+ri+',"li":'+li+"}"}}),pli=li,pri=ri,ph=h,pl=l,pspeed=speed,psteer=steer))}var speed=li=ri=h=l=start=pli=pri=ph=pl=pspeed=0,stop=1,psteer=steer=90;window.addEventListener("devicemotion",function(a){speed=mapvalue(parseFloat(a.accelerationIncludingGravity.x),0,9,255,-255),steer=mapvalue(parseFloat(a.accelerationIncludingGravity.y),-3,3,120,60),$("#speed").html(parseInt(speed)),$("#servo").html(parseInt(steer))}),window.setInterval(data,100);