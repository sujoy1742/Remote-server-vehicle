function canGame(){return"getGamepads"in navigator}function reportOnGamepad(){var a=navigator.getGamepads()[0],b=a.id;a.id.search("044f")!=-1&&a.id.search("b659")!=-1?(gphorn=7,gplight=1,gprighti=2,gplefti=0,gpsteer=0,gpspeed=3):(gphorn=1,gplight=0,gprighti=2,gplefti=3,gpsteer=0,gpspeed=1);for(var c=0;c<a.buttons.length;c++){if(horn=!1,a.buttons[gphorn].pressed&&(horn=!0),a.buttons[gplefti].pressed){if(0==leftindicator){leftindicator=!0;break}leftindicator=!1;break}if(a.buttons[gprighti].pressed){if(0==rightindicator){rightindicator=!0;break}rightindicator=!1;break}if(a.buttons[gplight].pressed){if(0==light){light=!0;break}light=!1;break}}for(var c=0;c<a.axes.length;c+=1)c==gpsteer&&(parseFloat(a.axes[c])<0?(steering=mapvalue(parseFloat(a.axes[c]),0,1,90,60),($("#steering-indicator").hasClass("left")||$("#steering-indicator").hasClass("arrow icon"))&&($("#steering-indicator").addClass("right"),$("#steering-indicator").removeClass("left"))):(steering=mapvalue(parseFloat(a.axes[c]),-1,0,120,90),($("#steering-indicator").hasClass("right")||$("#steering-indicator").hasClass("arrow icon"))&&($("#steering-indicator").addClass("left"),$("#steering-indicator").removeClass("right")))),c==gpspeed&&(parseFloat(a.axes[c])>0?(speed=mapvalue(parseFloat(a.axes[c]),0,1,0,-255),($("#speed-indicator").hasClass("up")||$("#speed-indicator").hasClass("arrow icon"))&&($("#speed-indicator").addClass("down"),$("#speed-indicator").removeClass("up"))):(speed=mapvalue(parseFloat(a.axes[c]),-1,0,255,0),($("#speed-indicator").hasClass("down")||$("#speed-indicator").hasClass("arrow icon"))&&($("#speed-indicator").addClass("up"),$("#speed-indicator").removeClass("down"))));if($("#gamepadDisplay").html(b),0==leftindicator){$("#leftindicator").addClass("negative"),$("#leftindicator").removeClass("positive");var d='"li":0'}else{$("#leftindicator").addClass("positive"),$("#leftindicator").removeClass("negative");var d='"li":1'}if(0==rightindicator){$("#rightindicator").addClass("negative"),$("#rightindicator").removeClass("positive");var e='"ri":0'}else{$("#rightindicator").addClass("positive"),$("#rightindicator").removeClass("negative");var e='"ri":1'}if(0==horn){$("#horn").addClass("negative"),$("#horn").removeClass("positive");var f='"h":0'}else{$("#horn").addClass("positive"),$("#horn").removeClass("negative");var f='"h":1'}if(0==light){$("#light").addClass("negative"),$("#light").removeClass("positive");var g='"l":0'}else{$("#light").addClass("positive"),$("#light").removeClass("negative");var g='"l":1'}$("#steering").html(parseInt(steering));var h='"s":'+parseInt(steering);$("#speed").html(parseInt(speed));var i='"m":'+parseInt(speed),j="{"+h+","+i+","+d+","+e+","+g+","+f+"}";paststeering==steering&&pastspeed==speed&&pastlight==light&&pasthorn==horn&&pastrightindicator==rightindicator&&pastleftindicator==leftindicator||($.ajax({url:"/post_data/",type:"POST",data:{data:j}}),pastleftindicator=leftindicator,pastrightindicator=rightindicator,pasthorn=horn,pastlight=light,pastspeed=speed,paststeering=steering)}function mapvalue(a,b,c,d,e){return(a-b)*(e-d)/(c-b)+d}var leftindicator=!1,rightindicator=!1,horn=!1,light=!1,steering=0,speed=0,pastleftindicator=!1,pastrightindicator=!1,pasthorn=!1,pastlight=!1,paststeering=0,pastspeed=0,hasGP=!1,repGP;$(document).ready(function(){if($(".ui.embed").embed(),canGame()){$(window).on("gamepadconnected",function(){hasGP=!0,repGP=window.setInterval(reportOnGamepad,100)}),$(window).on("gamepaddisconnected",function(){window.clearInterval(repGP)});var a=window.setInterval(function(){navigator.getGamepads()[0]&&(hasGP||$(window).trigger("gamepadconnected"),window.clearInterval(a))},500)}});